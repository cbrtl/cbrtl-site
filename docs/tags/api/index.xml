<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>api on cbrtl</title><link>https://cbrtl.github.io/tags/api/</link><description>Recent content in api on cbrtl</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Mon, 01 Apr 2024 00:00:00 +0000</lastBuildDate><atom:link href="https://cbrtl.github.io/tags/api/index.xml" rel="self" type="application/rss+xml"/><item><title>Nicedear: A Dynamic Avatar Generator</title><link>https://cbrtl.github.io/posts/nicedear/</link><pubDate>Mon, 01 Apr 2024 00:00:00 +0000</pubDate><guid>https://cbrtl.github.io/posts/nicedear/</guid><description>A random avatar generator for your website or app: a dicebear spoof.</description><content:encoded><![CDATA[<p><em>Og - <a href="https://anubhavp.dev/blog/nicedear.html">anubhavp.dev/blog/nicedear</a></em></p>
<p>Nicedear is a dynamic open-source avatar generator that crafts unique avatars based on user input. Whether you&rsquo;re crafting a personal brand, spicing up your social media, or adding flair to your website, Nicedear has you covered with its mesmerizing array of features and customization options.</p>
<!-- raw HTML omitted -->
<p>
  <img loading="lazy" src="https://anubhavp.dev/assets/img/nicedear/how.svg" alt="Nicedear: how"  /></p>
<!-- raw HTML omitted -->
<p>Source: <a href="https://api.nicedear.vip/?seed=how">Nicedear</a>, seed: &ldquo;how&rdquo;</p>
<h2 id="unveiling-the-magic">Unveiling the Magic</h2>
<p>Behind the scenes, Nicedear uses Node and TypeScript to generate the avatar. Here&rsquo;s the <a href="https://github.com/fuzzymfx/nicedear">source</a>, and here&rsquo;s how it works:</p>
<ol>
<li>With Nicedear, every avatar starts with a seed - a tiny spark that ignites a world of creativity. Whether you provide your own or let Nicedear conjure one for you, each seed undergoes a simple hashing function, converting it into a numerical value. This hash serves as the foundation for subsequent choices in the avatar&rsquo;s features.
<!-- raw HTML omitted --><!-- raw HTML omitted --></li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span><span style="font-weight:bold">const</span> hashString = (s: <span style="">string</span>): <span style="">number</span> =&gt; {
</span></span><span style="display:flex;"><span><span style="font-weight:bold">let</span> hash = 0;
</span></span><span style="display:flex;"><span><span style="font-weight:bold">if</span> (s.length === 0) <span style="font-weight:bold">return</span> hash;
</span></span><span style="display:flex;"><span><span style="font-weight:bold">for</span> (<span style="font-weight:bold">let</span> i = 0; i &lt; s.length; i++) {
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">const</span> chr = s.charCodeAt(i);
</span></span><span style="display:flex;"><span>  hash = (hash &lt;&lt; 5) - hash + chr;
</span></span><span style="display:flex;"><span>  hash |= 0; <span style="font-style:italic">// Convert to 32bit integer
</span></span></span><span style="display:flex;"><span><span style="font-style:italic"></span>}
</span></span><span style="display:flex;"><span><span style="font-weight:bold">return</span> hash;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ol start="2">
<li>Nicedear then uses the hash to select choices for each feature in the avatar. From captivating heads to charming facial hair, each aspect of your avatar is carefully curated to reflect your style and personality.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span> <span style="font-weight:bold">return</span> features.map((feature) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">const</span> index = hash % feature.choices.length;
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> feature.choices[index];
</span></span><span style="display:flex;"><span> });
</span></span></code></pre></div><p>The <strong>Feature Array</strong> is an array of Feature objects that contain the choices for each feature. <code>Head</code>, <code>Face</code>, <code>Facial-hair</code> are examples of features. Nicedear uses the hash to select a choice from each feature. A <strong>feature image</strong> (<em>a face</em>) is a choice from a set of choices(<em>a folder containing all the faces</em>) is selected based on the modulo of the hash and the number of choices in the feature.</p>
<p>Assuming Input = &ldquo;<code>fuzzymf</code>&rdquo;, the hash generated using the hash function <a href="#hashfunction">‚èé</a> is <code>497870557</code>. The hash is then divided by the number of faces present in the folder, say <code>25</code>, to get the modulo, which is <strong>7</strong>. The <strong>7th face</strong> is then selected from the folder containing all the <code>25</code> faces.</p>
<p>Similarly, the hash is used to select choices for other features, such as <code>Facial-hair</code> and <code>Head</code>.</p>
<p>Here&rsquo;s an example of a feature object, <code>a suspicious face</code>, from the theme <code>open-peeps</code>, when the input is <code>fuzzymfx</code>:</p>
<!-- raw HTML omitted -->
<p>
  <img loading="lazy" src="https://anubhavp.dev/assets/img/nicedear/Suspicious.svg" alt="A Suspicious Face"  /></p>
<!-- raw HTML omitted -->
<ol start="3">
<li>Nicedear then applies transformations to the selected choices, such as scaling, rotating, and mirroring, to create a unique avatar that captures your essence.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ts" data-lang="ts"><span style="display:flex;"><span> <span style="font-weight:bold">const</span> layers: <span style="">OverlayOptions</span>[] = <span style="font-weight:bold">await</span> Promise.all(imagePaths.map(<span style="font-weight:bold">async</span> (imgPath, i) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">const</span> feature = features[i];
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">const</span> layer: <span style="">OverlayOptions</span> = { input: <span style="">imgPath</span> };
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">if</span> (feature.top) layer.top = feature.top;
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">if</span> (feature.left) layer.left = feature.left;
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> layer;
</span></span><span style="display:flex;"><span> }));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="font-weight:bold">const</span> transparentBackground: <span style="">SharpOptions</span> = {
</span></span><span style="display:flex;"><span>  create: {
</span></span><span style="display:flex;"><span>   width: <span style="">1000</span>,
</span></span><span style="display:flex;"><span>   height: <span style="">1000</span>,
</span></span><span style="display:flex;"><span>   channels: <span style="">4</span>,
</span></span><span style="display:flex;"><span>   background: { r: <span style="">255</span>, g: <span style="">255</span>, b: <span style="">255</span>, alpha: <span style="">0</span> }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span> };
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">await</span> Sharp(transparentBackground).composite(layers).png().toFile(<span style="font-style:italic">`_output/</span><span style="font-weight:bold;font-style:italic">${</span>seed<span style="font-weight:bold;font-style:italic">}${</span>pathHash<span style="font-weight:bold;font-style:italic">}</span><span style="font-style:italic">.png`</span>);
</span></span><span style="display:flex;"><span>  <span style="font-weight:bold">return</span> <span style="font-weight:bold">await</span> applyTransformations(<span style="font-style:italic">`_output/</span><span style="font-weight:bold;font-style:italic">${</span>seed<span style="font-weight:bold;font-style:italic">}${</span>pathHash<span style="font-weight:bold;font-style:italic">}</span><span style="font-style:italic">.png`</span>, params);
</span></span></code></pre></div><p>Nicedear&rsquo;s transformative powers come to life. The selected choices are then layered over and composited together to form the avatar, and a png is created. The png (image) is then transformed and converted to <code>SVG</code>. Your tailored avatar is ready to be shared with the world.</p>
<h2 id="the-transformations">The Transformations</h2>
<p>Nicedear offers a plethora of transformation features to tailor the avatar according to specific preferences:</p>
<h3 id="parameters">Parameters</h3>
<ul>
<li><strong>seed</strong>: string<br>
Input for the random generator, ensuring reproducibility.</li>
<li><strong>theme</strong>: string<br>
Defines the visual theme of the avatar, with options including open-peeps, female, male, and more.</li>
<li><strong>mirror</strong>: boolean<br>
When set true, flips the image horizontally when set to true.</li>
<li><strong>rotate</strong>: number<br>
Rotates the image by a specified degree. Defaults to 0.</li>
<li><strong>background</strong>: string<br>
The hex code of the background color. Defaults to #ffffff.</li>
<li><strong>skinColor</strong>: string (<em>pending</em>)<br>
The hex code of the avatar&rsquo;s skin color. Defaults to #ffffff.</li>
<li><strong>hairColor</strong>: string (<em>pending</em>)<br>
The hex code of the avatar&rsquo;s hair color. Defaults to #000000.</li>
<li><strong>scale</strong>: number<br>
Adjusts the size of the avatar. Defaults to 1.0.</li>
<li><strong>transalteX</strong>: number<br>
Fine-tunes the x-coordinate of the avatar. Defaults to 0.</li>
<li><strong>transalteY</strong>: number<br>
Fine-tunes the y-coordinate of the avatar. Defaults to 0.</li>
<li><strong>features</strong>: string[]<br>
Specifies which features to include in the avatar, such as face, facial-hair, and head.</li>
</ul>
<h2 id="usage">Usage</h2>
<p>Whether through command-line interface or API requests, Nicedear offers seamless integration for avatar generation, whether you&rsquo;re a tech-savvy developer enthusiast or a casual user looking to spice up your online presence.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>node dist/index.js foo open-peeps true 45 red skinColor hairColor 1.0 10.0 20.0 face,facial-hair,head
</span></span></code></pre></div><p>And, an API request might look like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>GET http://localhost:3000/?seed=&lt;seed&gt;&amp;theme=&lt;theme&gt;&amp;mirror=&lt;mirror&gt;&amp;rotate=&lt;rotate&gt;&amp;background=&lt;background&gt;&amp;skincolor=&lt;skincolor&gt;&amp;hairColor=&lt;hairColor&gt;&amp;scale=&lt;scale&gt;&amp;transalteX=&lt;transalteX&gt;&amp;transalteY=&lt;transalteY&gt;&amp;features=face,facialHair,head
</span></span></code></pre></div><p>Or, a simple API request might look like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>api.nicedear.vip/?seed=asimpleone
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>
  <img loading="lazy" src="https://anubhavp.dev/assets/img/nicedear/takli.svg" alt="Nicedear: simple"  /></p>
<!-- raw HTML omitted -->
<p>And, a complex one might look like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>api.nicedear.vip/?seed=extreme&amp;theme=open-peeps&amp;mirror=true&amp;rotate=325&amp;scale=0.6&amp;transalteX=10.0&amp;transalteY=20.0&amp;features=face,facialHair,head
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>
  <img loading="lazy" src="https://anubhavp.dev/assets/img/nicedear/extreme.svg" alt="Nicedear: extreme"  /></p>
<!-- raw HTML omitted -->
<p>Or, just visit <a href="https://api.nicedear.vip">https://api.nicedear.vip</a> for a random avatar.</p>
<h2 id="whats-next">What&rsquo;s Next?</h2>
<p>The adventure doesn&rsquo;t end here! Nicedear is just getting started. In the coming days, brace yourselves for a tidal wave of new features - from multiple avatars to a kaleidoscope of themes, the future of avatar generation has never looked brighter.</p>
<p>Dive into the world of Nicedear today and let your imagination run wild. Your perfect avatar awaits, and the possibilities are endless!</p>
]]></content:encoded></item></channel></rss>